2022-03-13 14:07:46,422,422,INFO,Sampler_5f4f72::==================== 此智能体要发送数据到: 10.19.93.9, 连接的端口为: 9527 =================
2022-03-13 14:07:47,416,416,INFO,Sampler_5f4f72::---------------- policy fetcher将最新的模型存放的地方为: {'policy': {'default': PosixPath('/home/miao/Desktop/ICC/code_part/Worker/Download_model/5f4f72_default_max_average_SE.model')}, 'critic': {'default': PosixPath('/home/miao/Desktop/ICC/code_part/Worker/Download_model/5f4f72_default_max_average_SE.model')}} ----------------
2022-03-13 14:07:47,417,417,INFO,Sampler_5f4f72::======================= 构建fetcher成功, 创建最新模型请求套接字 ===============
2022-03-13 14:07:48,517,517,INFO,Sampler_5f4f72::------------ 完成AgentManager的构建 -----------
2022-03-13 14:07:50,580,580,INFO,Sampler_5f4f72::------------------ 完成采样端的构建，此worker的id为5f4f72 -----------------
2022-03-13 14:07:52,056,56,INFO,Sampler_5f4f72::======================== 重置环境 =======================
2022-03-13 14:07:53,381,381,INFO,Sampler_5f4f72::==================== 智能体重置，对于训练模式，就是同步configserver上面的模型，测试模式就是加载本地模型 ====================
2022-03-13 14:08:10,489,489,INFO,Sampler_5f4f72::----------- 模型重置，使用model_fetcher到的模型数据:{'url': {'policy': {'default': 'http://10.19.93.9:9002/policy_default_1647144640.497976'}, 'critic': {'default': 'http://10.19.93.9:9002/critic_default_1647144640.497976'}}, 'policy_name': 'max_average_SE', 'time_stamp': 1647144663.720485} -----------
2022-03-13 14:09:08,073,73,ERROR,Sampler_5f4f72::Error(s) in loading state_dict for model:
	Missing key(s) in state_dict: "conv_layer.weight", "pointer_decoder.init_decoder", "pointer_decoder.decoder.layers.0.self_attn.in_proj_weight", "pointer_decoder.decoder.layers.0.self_attn.in_proj_bias", "pointer_decoder.decoder.layers.0.self_attn.out_proj.weight", "pointer_decoder.decoder.layers.0.self_attn.out_proj.bias", "pointer_decoder.decoder.layers.0.multihead_attn.in_proj_weight", "pointer_decoder.decoder.layers.0.multihead_attn.in_proj_bias", "pointer_decoder.decoder.layers.0.multihead_attn.out_proj.weight", "pointer_decoder.decoder.layers.0.multihead_attn.out_proj.bias", "pointer_decoder.decoder.layers.0.linear1.weight", "pointer_decoder.decoder.layers.0.linear1.bias", "pointer_decoder.decoder.layers.0.linear2.weight", "pointer_decoder.decoder.layers.0.linear2.bias", "pointer_decoder.decoder.layers.0.norm1.weight", "pointer_decoder.decoder.layers.0.norm1.bias", "pointer_decoder.decoder.layers.0.norm2.weight", "pointer_decoder.decoder.layers.0.norm2.bias", "pointer_decoder.decoder.layers.0.norm3.weight", "pointer_decoder.decoder.layers.0.norm3.bias", "pointer_decoder.decoder.layers.1.self_attn.in_proj_weight", "pointer_decoder.decoder.layers.1.self_attn.in_proj_bias", "pointer_decoder.decoder.layers.1.self_attn.out_proj.weight", "pointer_decoder.decoder.layers.1.self_attn.out_proj.bias", "pointer_decoder.decoder.layers.1.multihead_attn.in_proj_weight", "pointer_decoder.decoder.layers.1.multihead_attn.in_proj_bias", "pointer_decoder.decoder.layers.1.multihead_attn.out_proj.weight", "pointer_decoder.decoder.layers.1.multihead_attn.out_proj.bias", "pointer_decoder.decoder.layers.1.linear1.weight", "pointer_decoder.decoder.layers.1.linear1.bias", "pointer_decoder.decoder.layers.1.linear2.weight", "pointer_decoder.decoder.layers.1.linear2.bias", "pointer_decoder.decoder.layers.1.norm1.weight", "pointer_decoder.decoder.layers.1.norm1.bias", "pointer_decoder.decoder.layers.1.norm2.weight", "pointer_decoder.decoder.layers.1.norm2.bias", "pointer_decoder.decoder.layers.1.norm3.weight", "pointer_decoder.decoder.layers.1.norm3.bias", "pointer_decoder.decoder.layers.2.self_attn.in_proj_weight", "pointer_decoder.decoder.layers.2.self_attn.in_proj_bias", "pointer_decoder.decoder.layers.2.self_attn.out_proj.weight", "pointer_decoder.decoder.layers.2.self_attn.out_proj.bias", "pointer_decoder.decoder.layers.2.multihead_attn.in_proj_weight", "pointer_decoder.decoder.layers.2.multihead_attn.in_proj_bias", "pointer_decoder.decoder.layers.2.multihead_attn.out_proj.weight", "pointer_decoder.decoder.layers.2.multihead_attn.out_proj.bias", "pointer_decoder.decoder.layers.2.linear1.weight", "pointer_decoder.decoder.layers.2.linear1.bias", "pointer_decoder.decoder.layers.2.linear2.weight", "pointer_decoder.decoder.layers.2.linear2.bias", "pointer_decoder.decoder.layers.2.norm1.weight", "pointer_decoder.decoder.layers.2.norm1.bias", "pointer_decoder.decoder.layers.2.norm2.weight", "pointer_decoder.decoder.layers.2.norm2.bias", "pointer_decoder.decoder.layers.2.norm3.weight", "pointer_decoder.decoder.layers.2.norm3.bias", "pointer_decoder.decoder.layers.3.self_attn.in_proj_weight", "pointer_decoder.decoder.layers.3.self_attn.in_proj_bias", "pointer_decoder.decoder.layers.3.self_attn.out_proj.weight", "pointer_decoder.decoder.layers.3.self_attn.out_proj.bias", "pointer_decoder.decoder.layers.3.multihead_attn.in_proj_weight", "pointer_decoder.decoder.layers.3.multihead_attn.in_proj_bias", "pointer_decoder.decoder.layers.3.multihead_attn.out_proj.weight", "pointer_decoder.decoder.layers.3.multihead_attn.out_proj.bias", "pointer_decoder.decoder.layers.3.linear1.weight", "pointer_decoder.decoder.layers.3.linear1.bias", "pointer_decoder.decoder.layers.3.linear2.weight", "pointer_decoder.decoder.layers.3.linear2.bias", "pointer_decoder.decoder.layers.3.norm1.weight", "pointer_decoder.decoder.layers.3.norm1.bias", "pointer_decoder.decoder.layers.3.norm2.weight", "pointer_decoder.decoder.layers.3.norm2.bias", "pointer_decoder.decoder.layers.3.norm3.weight", "pointer_decoder.decoder.layers.3.norm3.bias", "pointer_decoder.decoder.layers.4.self_attn.in_proj_weight", "pointer_decoder.decoder.layers.4.self_attn.in_proj_bias", "pointer_decoder.decoder.layers.4.self_attn.out_proj.weight", "pointer_decoder.decoder.layers.4.self_attn.out_proj.bias", "pointer_decoder.decoder.layers.4.multihead_attn.in_proj_weight", "pointer_decoder.decoder.layers.4.multihead_attn.in_proj_bias", "pointer_decoder.decoder.layers.4.multihead_attn.out_proj.weight", "pointer_decoder.decoder.layers.4.multihead_attn.out_proj.bias", "pointer_decoder.decoder.layers.4.linear1.weight", "pointer_decoder.decoder.layers.4.linear1.bias", "pointer_decoder.decoder.layers.4.linear2.weight", "pointer_decoder.decoder.layers.4.linear2.bias", "pointer_decoder.decoder.layers.4.norm1.weight", "pointer_decoder.decoder.layers.4.norm1.bias", "pointer_decoder.decoder.layers.4.norm2.weight", "pointer_decoder.decoder.layers.4.norm2.bias", "pointer_decoder.decoder.layers.4.norm3.weight", "pointer_decoder.decoder.layers.4.norm3.bias", "pointer_decoder.decoder.layers.5.self_attn.in_proj_weight", "pointer_decoder.decoder.layers.5.self_attn.in_proj_bias", "pointer_decoder.decoder.layers.5.self_attn.out_proj.weight", "pointer_decoder.decoder.layers.5.self_attn.out_proj.bias", "pointer_decoder.decoder.layers.5.multihead_attn.in_proj_weight", "pointer_decoder.decoder.layers.5.multihead_attn.in_proj_bias", "pointer_decoder.decoder.layers.5.multihead_attn.out_proj.weight", "pointer_decoder.decoder.layers.5.multihead_attn.out_proj.bias", "pointer_decoder.decoder.layers.5.linear1.weight", "pointer_decoder.decoder.layers.5.linear1.bias", "pointer_decoder.decoder.layers.5.linear2.weight", "pointer_decoder.decoder.layers.5.linear2.bias", "pointer_decoder.decoder.layers.5.norm1.weight", "pointer_decoder.decoder.layers.5.norm1.bias", "pointer_decoder.decoder.layers.5.norm2.weight", "pointer_decoder.decoder.layers.5.norm2.bias", "pointer_decoder.decoder.layers.5.norm3.weight", "pointer_decoder.decoder.layers.5.norm3.bias", "pointer_decoder.decoder.norm.weight", "pointer_decoder.decoder.norm.bias", "pointer_decoder.affine_layer.weight", "pointer_decoder.affine_layer.bias", "pointer_decoder.embedding_layer.weight", "pointer_decoder.embedding_layer.bias". 
	Unexpected key(s) in state_dict: "channel_conv_layer.weight", "reward_conv_layer.weight", "count_conv_layer.weight", "concatenat_conv_layer.weight", "feature_contraction.weight", "value_head.weight", "value_head.bias". 
	size mismatch for embedding_layer.weight: copying a param with shape torch.Size([512, 32]) from checkpoint, the shape in current model is torch.Size([512, 96]).
2022-03-13 14:09:08,351,351,ERROR,Sampler_5f4f72::Traceback (most recent call last):
  File "/home/miao/Desktop/ICC/code_part/Worker/sampler.py", line 77, in run_loop
    self.run()
  File "/home/miao/Desktop/ICC/code_part/Worker/sampler.py", line 50, in run
    mean_instant_SE_sum, mean_edge_average_SE, mean_PF_sum, scheduling_count = self.rollout.run_one_episode()
  File "/home/miao/Desktop/ICC/code_part/Worker/rollout.py", line 68, in run_one_episode
    self.agent.reset()
  File "/home/miao/Desktop/ICC/code_part/Worker/agent.py", line 155, in reset
    self.synchronize_model()
  File "/home/miao/Desktop/ICC/code_part/Worker/agent.py", line 139, in synchronize_model
    self.agent[model_type][model_name].synchronize_model(self.policy_fetcher.model_path[model_type][model_name])
  File "/home/miao/Desktop/ICC/code_part/Worker/agent.py", line 25, in synchronize_model
    deserialize_model(self.net_work, model_path)
  File "/home/miao/Desktop/ICC/code_part/Utils/model_utils.py", line 54, in deserialize_model
    model_object.load_state_dict(new_state_dict)
  File "/home/miao/.conda/envs/Pytorch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1482, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for model:
	Missing key(s) in state_dict: "conv_layer.weight", "pointer_decoder.init_decoder", "pointer_decoder.decoder.layers.0.self_attn.in_proj_weight", "pointer_decoder.decoder.layers.0.self_attn.in_proj_bias", "pointer_decoder.decoder.layers.0.self_attn.out_proj.weight", "pointer_decoder.decoder.layers.0.self_attn.out_proj.bias", "pointer_decoder.decoder.layers.0.multihead_attn.in_proj_weight", "pointer_decoder.decoder.layers.0.multihead_attn.in_proj_bias", "pointer_decoder.decoder.layers.0.multihead_attn.out_proj.weight", "pointer_decoder.decoder.layers.0.multihead_attn.out_proj.bias", "pointer_decoder.decoder.layers.0.linear1.weight", "pointer_decoder.decoder.layers.0.linear1.bias", "pointer_decoder.decoder.layers.0.linear2.weight", "pointer_decoder.decoder.layers.0.linear2.bias", "pointer_decoder.decoder.layers.0.norm1.weight", "pointer_decoder.decoder.layers.0.norm1.bias", "pointer_decoder.decoder.layers.0.norm2.weight", "pointer_decoder.decoder.layers.0.norm2.bias", "pointer_decoder.decoder.layers.0.norm3.weight", "pointer_decoder.decoder.layers.0.norm3.bias", "pointer_decoder.decoder.layers.1.self_attn.in_proj_weight", "pointer_decoder.decoder.layers.1.self_attn.in_proj_bias", "pointer_decoder.decoder.layers.1.self_attn.out_proj.weight", "pointer_decoder.decoder.layers.1.self_attn.out_proj.bias", "pointer_decoder.decoder.layers.1.multihead_attn.in_proj_weight", "pointer_decoder.decoder.layers.1.multihead_attn.in_proj_bias", "pointer_decoder.decoder.layers.1.multihead_attn.out_proj.weight", "pointer_decoder.decoder.layers.1.multihead_attn.out_proj.bias", "pointer_decoder.decoder.layers.1.linear1.weight", "pointer_decoder.decoder.layers.1.linear1.bias", "pointer_decoder.decoder.layers.1.linear2.weight", "pointer_decoder.decoder.layers.1.linear2.bias", "pointer_decoder.decoder.layers.1.norm1.weight", "pointer_decoder.decoder.layers.1.norm1.bias", "pointer_decoder.decoder.layers.1.norm2.weight", "pointer_decoder.decoder.layers.1.norm2.bias", "pointer_decoder.decoder.layers.1.norm3.weight", "pointer_decoder.decoder.layers.1.norm3.bias", "pointer_decoder.decoder.layers.2.self_attn.in_proj_weight", "pointer_decoder.decoder.layers.2.self_attn.in_proj_bias", "pointer_decoder.decoder.layers.2.self_attn.out_proj.weight", "pointer_decoder.decoder.layers.2.self_attn.out_proj.bias", "pointer_decoder.decoder.layers.2.multihead_attn.in_proj_weight", "pointer_decoder.decoder.layers.2.multihead_attn.in_proj_bias", "pointer_decoder.decoder.layers.2.multihead_attn.out_proj.weight", "pointer_decoder.decoder.layers.2.multihead_attn.out_proj.bias", "pointer_decoder.decoder.layers.2.linear1.weight", "pointer_decoder.decoder.layers.2.linear1.bias", "pointer_decoder.decoder.layers.2.linear2.weight", "pointer_decoder.decoder.layers.2.linear2.bias", "pointer_decoder.decoder.layers.2.norm1.weight", "pointer_decoder.decoder.layers.2.norm1.bias", "pointer_decoder.decoder.layers.2.norm2.weight", "pointer_decoder.decoder.layers.2.norm2.bias", "pointer_decoder.decoder.layers.2.norm3.weight", "pointer_decoder.decoder.layers.2.norm3.bias", "pointer_decoder.decoder.layers.3.self_attn.in_proj_weight", "pointer_decoder.decoder.layers.3.self_attn.in_proj_bias", "pointer_decoder.decoder.layers.3.self_attn.out_proj.weight", "pointer_decoder.decoder.layers.3.self_attn.out_proj.bias", "pointer_decoder.decoder.layers.3.multihead_attn.in_proj_weight", "pointer_decoder.decoder.layers.3.multihead_attn.in_proj_bias", "pointer_decoder.decoder.layers.3.multihead_attn.out_proj.weight", "pointer_decoder.decoder.layers.3.multihead_attn.out_proj.bias", "pointer_decoder.decoder.layers.3.linear1.weight", "pointer_decoder.decoder.layers.3.linear1.bias", "pointer_decoder.decoder.layers.3.linear2.weight", "pointer_decoder.decoder.layers.3.linear2.bias", "pointer_decoder.decoder.layers.3.norm1.weight", "pointer_decoder.decoder.layers.3.norm1.bias", "pointer_decoder.decoder.layers.3.norm2.weight", "pointer_decoder.decoder.layers.3.norm2.bias", "pointer_decoder.decoder.layers.3.norm3.weight", "pointer_decoder.decoder.layers.3.norm3.bias", "pointer_decoder.decoder.layers.4.self_attn.in_proj_weight", "pointer_decoder.decoder.layers.4.self_attn.in_proj_bias", "pointer_decoder.decoder.layers.4.self_attn.out_proj.weight", "pointer_decoder.decoder.layers.4.self_attn.out_proj.bias", "pointer_decoder.decoder.layers.4.multihead_attn.in_proj_weight", "pointer_decoder.decoder.layers.4.multihead_attn.in_proj_bias", "pointer_decoder.decoder.layers.4.multihead_attn.out_proj.weight", "pointer_decoder.decoder.layers.4.multihead_attn.out_proj.bias", "pointer_decoder.decoder.layers.4.linear1.weight", "pointer_decoder.decoder.layers.4.linear1.bias", "pointer_decoder.decoder.layers.4.linear2.weight", "pointer_decoder.decoder.layers.4.linear2.bias", "pointer_decoder.decoder.layers.4.norm1.weight", "pointer_decoder.decoder.layers.4.norm1.bias", "pointer_decoder.decoder.layers.4.norm2.weight", "pointer_decoder.decoder.layers.4.norm2.bias", "pointer_decoder.decoder.layers.4.norm3.weight", "pointer_decoder.decoder.layers.4.norm3.bias", "pointer_decoder.decoder.layers.5.self_attn.in_proj_weight", "pointer_decoder.decoder.layers.5.self_attn.in_proj_bias", "pointer_decoder.decoder.layers.5.self_attn.out_proj.weight", "pointer_decoder.decoder.layers.5.self_attn.out_proj.bias", "pointer_decoder.decoder.layers.5.multihead_attn.in_proj_weight", "pointer_decoder.decoder.layers.5.multihead_attn.in_proj_bias", "pointer_decoder.decoder.layers.5.multihead_attn.out_proj.weight", "pointer_decoder.decoder.layers.5.multihead_attn.out_proj.bias", "pointer_decoder.decoder.layers.5.linear1.weight", "pointer_decoder.decoder.layers.5.linear1.bias", "pointer_decoder.decoder.layers.5.linear2.weight", "pointer_decoder.decoder.layers.5.linear2.bias", "pointer_decoder.decoder.layers.5.norm1.weight", "pointer_decoder.decoder.layers.5.norm1.bias", "pointer_decoder.decoder.layers.5.norm2.weight", "pointer_decoder.decoder.layers.5.norm2.bias", "pointer_decoder.decoder.layers.5.norm3.weight", "pointer_decoder.decoder.layers.5.norm3.bias", "pointer_decoder.decoder.norm.weight", "pointer_decoder.decoder.norm.bias", "pointer_decoder.affine_layer.weight", "pointer_decoder.affine_layer.bias", "pointer_decoder.embedding_layer.weight", "pointer_decoder.embedding_layer.bias". 
	Unexpected key(s) in state_dict: "channel_conv_layer.weight", "reward_conv_layer.weight", "count_conv_layer.weight", "concatenat_conv_layer.weight", "feature_contraction.weight", "value_head.weight", "value_head.bias". 
	size mismatch for embedding_layer.weight: copying a param with shape torch.Size([512, 32]) from checkpoint, the shape in current model is torch.Size([512, 96]).

